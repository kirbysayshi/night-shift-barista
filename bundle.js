!function(){"use strict";function e(e,t){return t={exports:{}},e(t,t.exports),t.exports}function t(){var e=35208;return function(){var t=e>>1&1,r=e>>9&1,n=t^r;return e=(n<<15|e>>>1)>>>0}}function r(e){return function(){var t=(e()-2)/65532;return t}}function n(e,t,r,n,i){var a=document.createElement("canvas");a.width=e.width,a.height=e.height;var o=a.getContext("2d");o.drawImage(e,0,0);for(var s=o.getImageData(0,0,a.width,a.height),u=s.data,c=0;c<u.length;c+=4)u[c+0]=t,u[c+1]=r,u[c+2]=n,u[c+3]=0!==u[c+3]?i:0;return o.putImageData(s,0,0),a}function i(e,i,a){var o,s=12,u=9,c=16,l=(o={},Ce(o,Z,{x:0,y:5*s,w:s,h:s}),Ce(o,z,{x:0,y:4*s,w:s,h:s}),Ce(o,Q,{x:0,y:3*s,w:s,h:s}),Ce(o,X,{x:0,y:7*s,w:s,h:s}),Ce(o,ue,{x:0,y:9*s,w:s,h:s}),Ce(o,ce,{x:0,y:10*s,w:s,h:s}),Ce(o,le,{x:0,y:11*s,w:s,h:s}),Ce(o,he,{x:0,y:12*s,w:s,h:s}),Ce(o,de,{x:0,y:14*s,w:s,h:s}),Ce(o,fe,{x:0,y:13*s,w:s,h:s}),Ce(o,q,{x:0,y:0*s,w:s,h:s}),Ce(o,te,{x:0,y:8*s,w:s,h:s}),Ce(o,me,{x:0,y:15*s,w:s,h:s}),Ce(o,ye,{x:0,y:99*s,w:s,h:s}),Ce(o,$,{x:0,y:6*s,w:s,h:s}),Ce(o,ee,{x:0,y:1*s,w:s,h:s}),Ce(o,re,{x:0,y:2*s,w:s,h:s}),Ce(o,ne,{x:0,y:20*s,w:s,h:s}),Ce(o,ie,{x:0,y:19*s,w:s,h:s}),Ce(o,ae,{x:0,y:18*s,w:s,h:s}),Ce(o,oe,{x:0,y:16*s,w:s,h:s}),Ce(o,se,{x:0,y:17*s,w:s,h:s}),o),h={"0,0-2,8":ne,"3,0-8,9":ie,"0,9-15,15":ie,"8,0-8,1":oe,"8,4":se,"8,6":se,"8,8":se,"8,10":se,"0,9-2,9":ae},d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!?&.'-○✗❤★♪:█,",f={2:"ilI!.':,",3:"t1",4:"abcdefghjknopqrsuvxyzL?-",5:"ABCDEFGHJKNOPRSUZ023456789& █",6:"mwMQTVWXY○✗❤★♪"},p=n(a,255,0,0,255),v={debug:!1,view:"BOOT_GAME_VIEW",SPRITE_SIZE:s,SPRITE_COLS:u,SPRITE_ROWS:c,screen:M(e,s*u,s*c,2),tileImage:i,tileSet:l,tileMap:h,fontImage:a,fontImageWhite:a,fontImageBlack:p,fontChrWidths:f,fontChrOrder:d,rng:r(t()),customers:[],orders:[],money:0,reputation:0,totalCustomersServed:0,rareCustomers:[],levelTime:0,levelMaxTime:10*F*100,sun:{position:{start:0,end:0},height:{start:0,end:0},distance:{start:0,end:0}},levelIdx:0,lastCustomerSpawnDT:0,customerNames:["Benjamin","Kira","Julian","Miles","Jadzia","Keiko","Kasidy","Jake","Worf"].map(function(e){return{name:e,hasSpawned:!1}}),levels:[{wants:[{type:he,rarity:0,minimumTime:10*F*10}]},{wants:[{type:pe,rarity:.3,minimumTime:10*F*10,name:"El Hombre de Leche",hasSpawnedOnce:!1},{type:ce,rarity:.2,minimumTime:10*F*10},{type:he,rarity:0,minimumTime:10*F*10}]},{wants:[{type:ce,rarity:.5,minimumTime:10*F*10},{type:le,rarity:.3,minimumTime:10*F*10},{type:he,rarity:.1,minimumTime:10*F*10}]}],log:[],hasLoggedElapsedForPct:{},stations:{offset:{cols:2,rows:we},entries:[{type:q,name:"The Register"},{type:ee,name:"Counter",has:[]},{type:re,name:"Cup Counter"},{type:Q,name:"Hot Water",has:[],timer:{value:0,max:10,hold:!0,active:!1,green:1,red:1}},{type:z,name:"Grouphead",has:[{type:de}],timer:{value:0,max:30,hold:!1,active:!1,green:.55,red:.95}},{type:Z,name:"Milk Steamer",has:[],timer:{value:0,max:30,hold:!0,active:!1,green:.55,red:.95}},{type:$,name:"Trash / Grounds Chute"},{type:X,name:"Grinder",setting:20,has:[],timer:{value:0,max:10,hold:!0,active:!1,green:1,red:1}},{type:te,name:"The Counter",has:[]}]},player:{isActivating:!1,position:{cols:0,rows:0},offset:{cols:0,rows:we},field:{cols:1,rows:8},has:[]}};return v.sun.position.start=4*v.screen.height,v.sun.position.end=v.screen.height/3,v.sun.distance.start=v.sun.distance.end=v.screen.width/2,v.sun.height.start=v.screen.height/2,v.sun.height.end=3*v.screen.height,v}function a(e){var t=(e.player,e.player.position),r=e.stations.entries,n=r[t.rows];return n}function o(e,t,r){var n=t.has.findIndex(function(e){return e.type===r});if(n!==-1){var i=t.has.splice(n,1);e.has.push(i[0]),e.has.sort(f)}}function s(e,t,r){var n={type:t,sprite:r||t};return e.has.push(n),e.has.sort(f),n}function u(e,t){return e.has.find(function(e){return e.type===t})}function c(e,t){var r=e.has.findIndex(function(e){return e.type===t});if(r!==-1)return e.has.splice(r,1)[0]}function l(e){e.has.length=0}function h(e){return e.has[0].type}function d(e,t){for(var r=function(r){if(e.has.find(function(e){return e.type===t[r]}))return{v:t[r]}},n=0;n<t.length;n++){var i=r(n);if("object"===("undefined"==typeof i?"undefined":be(i)))return i.v}return!1}function f(e,t){return e.type===de||e.type===fe?1:t.type===de||t.type===fe?-1:0}function p(e,t){if(t.type===Ie)return e.view=Ie,e;if(t.type===Y){var r=i(e.screen.cvs,e.tileImage,e.fontImage);return r.money=e.money,r.reputation=e.reputation,r.totalCustomersServed=e.totalCustomersServed,r.levelIdx=e.view===Te?0:e.levelIdx+1,r.view=Oe,r}if(t.type===xe)return e.view=Pe,e.customers.forEach(function(t){t.paid===!0&&(e.reputation-=Ee)}),e;if(t.type===K)return e.debug=!e.debug,e;if(t.type===G){var n=e.player;return n.isActivating=!1,e}if(t.type===V){var f=(e.SPRITE_COLS,{name:t.data.name,wants:t.data.wants,rare:t.data.rare,paid:!1,position:{rows:0,cols:0}});return e.customers.push(f),v(e),e}if(t.type===U){var p=e.player.position.rows-=1;return p<0&&(e.player.position.rows=0),e}if(t.type===B){var m=e.player.position.rows+=1;return m>=e.player.field.rows&&(e.player.position.rows=e.player.field.rows),e}if(t.type===j){var y=e.log;for(y.push(t.data);y.length>5;)y.shift();return e}if(t.type===k&&e.view===Oe){e.levelTime+=F,e.rng();for(var g=e.player,w=e.stations,E=a(e),S=0;S<w.entries.length;S++){var T=w.entries[S];if(T.timer){if(T.timer.active&&T.timer.value/T.timer.max>=T.timer.green){if(T.type===z&&u(T,ue)&&(c(T,ue),s(T,he)),T.type===z&&u(T,ve)&&(c(T,ve),s(T,ce)),T.type===Q&&u(T,he)){var I=c(T,he),x=s(T,ce);x.wellBrewed=I.wellBrewed}if(T.type===Q&&u(T,ue)){var O=c(T,ue),P=s(T,ve,ue);P.wellBrewed=O.wellBrewed}if(T.type===Z&&u(T,he)){var b=c(T,he),C=s(T,le);C.wellBrewed=b.wellBrewed}if(T.type===Z&&u(T,ue)){var R=c(T,ue),_=s(T,pe,le);_.wellBrewed=R.wellBrewed}}if(T.timer.active&&T.timer.value>=T.timer.max&&(T.timer.active=!1,T.type===X))return l(T),s(T,fe),e;T.timer.hold&&T.timer.active&&E===T&&g.isActivating&&(T.timer.value+=1),!T.timer.hold&&T.timer.active&&(T.timer.value+=1)}}return e}if(t.type===H){var L=e.player,A=a(e);if(A.type===Q){if((u(L,he)||u(L,ue))&&0===A.has.length)return o(A,L,h(L)),e;if(1===A.has.length&&(u(A,he)||u(A,ue)))return A.timer.active=!0,L.isActivating=!0,e;if(A.has.length&&A.timer.active===!1)return o(L,A,h(A)),A.timer.value=0,e}if(A.type===z){if(u(A,fe)&&(u(A,ue)||u(A,ve)))return A.timer.active=!0,L.isActivating=!0,e;if(u(A,fe)&&A.timer.active===!0)return A.timer.active=!1,L.isActivating=!0,e;if(0===L.has.length&&u(A,fe)&&(u(A,he)||u(A,ce))){var M=d(A,[he,ce]);o(L,A,M);var D=A.timer.value/A.timer.max;return L.has[0].wellBrewed=D<=A.timer.red,c(A,fe),s(A,de),A.timer.value=0,e}if(u(A,de)&&0===L.has.length)return o(L,A,de),e;if((u(L,de)||u(L,fe))&&!u(A,de)&&!u(A,fe))return o(A,L,h(L)),e;if((u(L,ue)||u(L,ve))&&!u(A,ue)&&!u(A,ce)&&!u(A,he)&&!u(A,le)&&!u(A,ve))return o(A,L,h(L)),e}if(A.type===re){if(0===L.has.length)return s(L,ue),e;if(u(L,ue))return c(L,ue),e}if(A.type===q){for(var W=0;W<e.customers.length;W++){var N=e.customers[W];if(!N.paid){e.money+=5,N.paid=!0;break}}return e}if(A.type===X&&u(A,de))return L.isActivating=!0,A.timer.active=!0,e;if(A.type===X&&u(A,fe)&&!L.isActivating)return o(L,A,fe),A.timer.value=0,e;if(A.type===X&&u(L,de))return o(A,L,de),e;if(A.type===$){if(u(L,fe))return c(L,fe),s(L,de),e;if(L.has.length&&!u(L,de))return c(L,h(L)),e}if(A.type===Z){if(0===A.has.length&&(u(L,he)||u(L,ce)||u(L,ue)))return o(A,L,h(L)),e;if(u(A,he)||u(A,ce)||u(A,ue))return L.isActivating=!0,A.timer.active=!0,e;if(0!==A.has.length&&0===L.has.length&&!L.isActivating)return o(L,A,h(A)),A.timer.value=0,e}}if(t.type===J){var ee=e.player;if(u(ee,he)||u(ee,le)||u(ee,ce)||u(ee,pe)||u(ee,ve)){var te=h(ee),ne=c(ee,te),ie=e.customers,ae=t.data;ne.wellBrewed&&(e.reputation+=Ee),e.totalCustomersServed+=1;var oe=ie.splice(ae,1),se=Re(oe,1),me=se[0];v(e),me&&me.rare&&e.rareCustomers.push(me)}}return e}function v(e){var t=.5,r=e.customers,n=e.SPRITE_COLS;r.forEach(function(e,r){e.position={rows:t+r,cols:Math.floor(n/2)}})}function m(e,t,r,n){var i=e.SPRITE_SIZE,a=e.screen,o=e.tileSet,s=e.tileImage,u=a.scale,c=o[t];a.ctx.drawImage(s,c.x,c.y,c.w,c.h,r*i*u,n*i*u,i*u,i*u)}function y(e,t){for(var r=t.player,n=r.offset,i=r.position,a=i.cols,o=i.rows,s=n.cols+a,u=n.rows+o,c=0;c<r.has.length;c++){var l=r.has[c];m(t,l.sprite||l.type,s+.5,u)}m(t,me,s,u)}function g(e,t,r,n,i,a,o){var s=e.SPRITE_SIZE,u=e.screen,c=u.scale,l=s*c,h=l/3,d=l-h,f=t/r,p=f*l,v=f<a?"rgba(255,255,255,0.8)":f>=a&&f<=o?"rgba(0,255,0,0.8)":"rgba(255,0,0,0.8)";u.ctx.fillStyle=v,u.ctx.fillRect(n*s*c,i*s*c+d,p,h)}function w(e,t){var r=t.stations,n=r.offset,i=r.entries,a=n.cols,o=n.rows;i.forEach(function(e,r){var n=o;if(m(t,e.type,a,n),e.has)for(var i=0;i<e.has.length;i++){var s=e.has[i];m(t,s.sprite||s.type,a-1,n)}e.timer&&e.timer.value>0&&g(t,e.timer.value,e.timer.max,a,n,e.timer.green,e.timer.red),o+=1})}function E(e,t,r,n){var i=arguments.length<=4||void 0===arguments[4]?Se:arguments[4],a=arguments.length<=5||void 0===arguments[5]?1:arguments[5],o=e.SPRITE_SIZE,s=e.fontChrWidths,u=e.fontChrOrder,c=e.fontImageWhite,l=e.fontImageBlack,h=e.screen,d=h.scale,f=i===Se?c:l,p=Object.keys(s).reduce(function(e,t){return s[t].split("").forEach(function(r){return e[r]=parseInt(t,10)}),e},{}),v=o*d*r,m=o*d*n;t.split("").forEach(function(e){for(var t=0,r=0;r<u.length;r++){var n=u[r];if(e===n)break;t+=p[n]}" "!==e&&h.ctx.drawImage(f,t,0,p[e],f.height,v,m,p[e]*a,f.height*a),v+=p[e]*a})}function S(e,t){var r=t.customers,n=t.SPRITE_COLS,i=.5;E(t,"CUSTOMERS",Math.floor(n/2),i+we),r.forEach(function(e,r){var n=e.wants,a=(n.type,n.name),o=e.position,s=o.cols,u=o.rows;E(t,(e.paid?"":"█ ")+e.name+": "+a,s,i+u+we)})}function T(e,t){for(var r=(t.stations,t.screen,t.tileSet,t.tileMap),n=(t.SPRITE_COLS,t.SPRITE_ROWS,Object.keys(r)),i=0;i<n.length;i++){var a=n[i],o=a;a.indexOf("-")===-1&&(a=a+"-"+a);var s=/(\d+),(\d+)-(\d+),(\d+)/g,u=s.exec(a),c=Re(u,5),l=c[1],h=c[2],d=c[3],f=c[4];l=parseInt(l,10),h=parseInt(h,10),d=parseInt(d,10),f=parseInt(f,10);for(var p=l;p<=d;p++)for(var v=h;v<=f;v++)m(t,r[o],p,v)}}function I(e,t,r,n){return 0==e?t:r*Math.pow(2,10*(e/n-1))+t}function x(e,t){var r=t.SPRITE_COLS,n=t.SPRITE_ROWS,i=t.tileMap,a=t.sun,o=t.screen,s=I(t.levelTime,0,t.levelMaxTime,t.levelMaxTime),u=s/t.levelMaxTime,c=-1*a.distance.start,l=a.position.start+(a.position.end-a.position.start)*u,h=a.height.start+(a.height.end-a.height.start)*u,d=h/2,f=Object.keys(i).filter(function(e){return i[e]===se||i[e]===oe}),p=/(\d+),(\d+)/,v=o.width/r,m=o.height/n;o.ctx.save(),o.ctx.globalCompositeOperation="lighter";for(var y=0;y<f.length;y++){var g=f[y];if(g.indexOf("-")>-1){var w=g.split("-"),E=Re(w,2),S=E[1];f.push(S)}var T=p.exec(g),x=Re(T,3),O=x[1],P=x[2];O=parseInt(O,10),P=parseInt(P,10),o.ctx.fillStyle="rgba(255, 255, 255, "+.1*u+")",o.ctx.beginPath(),o.ctx.moveTo((O+1)*v,P*m),o.ctx.lineTo(c,l-d),o.ctx.lineTo(c,l+d),o.ctx.lineTo((O+1)*v,(P+1)*m),o.ctx.fill()}o.ctx.restore()}function O(e,t){var r=t.screen;t.tileSet,t.tileMap,t.SPRITE_COLS,t.SPRITE_ROWS;r.ctx.fillStyle="rgba(0,0,0,0.7)",r.ctx.fillRect(0,0,r.width,r.height);var n=3;E(t,"Night-Shift",1,2,Se,n),E(t,"Barista",1,3,Se,n);var i=.5,a=6.5;E(t,"You are the sole barista at a 24-hour coffee",1,a+=i),E(t,"shop. Serve your customers the glitching brew",1,a+=i),E(t,"their sleepless brains require, while waiting",1,a+=i),E(t,"for the safety of the sun.",1,a+=i);var o=a+3*i;E(t,"CONTROLS:",1,o+=i),E(t,"UP: Move up",1,o+=i),E(t,"DOWN: Move down",1,o+=i),E(t,"RIGHT: Activate - Pick up - Put down",1,o+=i);var s=1;E(t,"Programming & Design: Drew Petersen",1,14,Se,s),E(t,"Sprites: Lisa Leung",1,14.5,Se,s),E(t,"A 2016 JS13k Competition Entry",1,15,Se,s)}function P(e,t){var r=t.log,n=10,i=.5;E(t,"THOUGHTS",ge,n),r.forEach(function(e,r){E(t,e,ge,n+=i)})}function b(e,t){var r=t.screen;t.tileSet,t.tileMap,t.SPRITE_COLS,t.SPRITE_ROWS;r.ctx.fillStyle="rgba(0,0,0,0.7)",r.ctx.fillRect(0,0,r.width,r.height);var n=2;E(t,"Weekly",1,2,Se,n),E(t,"Night-Shifts:",1,3,Se,n),E(t,"Complete!",1,4,Se,n);var i=.5,a=4.5;E(t,"❤: "+t.reputation,1,a+=i),E(t,"█: "+t.money,1,a+=i),E(t,"Customers: "+t.totalCustomersServed,1,a+=i);var o=1;E(t,"Thank you for playing!",1,a+=i,Se,o)}function C(e,t){var r=t.screen,n=(t.tileSet,t.tileMap,t.SPRITE_COLS,t.SPRITE_ROWS,t.rareCustomers);r.ctx.fillStyle="rgba(0,0,0,0.7)",r.ctx.fillRect(0,0,r.width,r.height);var i=2;E(t,"Shift Complete!",1,2,Se,i);var a=4;n.length&&(E(t,"Interesting people:",1,a),n.forEach(function(e){E(t,e.name,1,a+=.5)})),a++,E(t,"The next night",1,++a,Se,i),E(t,"... Begins!",1,++a,Se,i)}function R(){Promise.all([D("assets/tiles.png"),D("assets/m05-short.png")]).then(function(e){var t=Re(e,2),r=t[0],n=t[1],a=new A(p,i(window.c,r,n));a.subscribe(function(){var e=a.getState();if(e.debug){var t=window.d;t||(t=document.createElement("pre"),t.id="d",t.style="display:block;position:absolute;color:white;overflow:scroll;z-index:9000;height:100%;width:100%;top:0;left:0",document.body.appendChild(t)),t.innerHTML=JSON.stringify(a.getState(),null,"  ")}_(1,e)});var o=W({drawTime:N,updateTime:F,draw:function(e){},update:function(e){a.dispatch({type:k,data:e}),a.dispatch(_e()),a.dispatch(Me()),a.dispatch(Ae())}});document.body.addEventListener("keydown",function(e){27===e.which&&(o.stop(),console.log("halt in the name of science")),[37,38,39,40].indexOf(e.which)>-1&&e.preventDefault(),38===e.which&&a.dispatch({type:U}),40===e.which&&a.dispatch({type:B}),39===e.which&&a.dispatch(Le()),188===e.which&&e.metaKey&&e.shiftKey&&a.dispatch({type:K})},!1),document.body.addEventListener("keyup",function(e){39===e.which&&a.dispatch({type:G})},!1),"ontouchstart"in window&&(window.ipt.style.display="block",window.btnup.addEventListener("touchend",function(e){e.preventDefault(),a.dispatch({type:U})},!1),window.btndown.addEventListener("touchend",function(e){e.preventDefault(),a.dispatch({type:B})},!1),window.btnact.addEventListener("touchstart",function(e){e.preventDefault(),a.dispatch(Le())},!1),window.btnact.addEventListener("touchend",function(e){e.preventDefault(),a.dispatch({type:G})},!1),document.body.addEventListener("touchstart",function(e){return e.preventDefault()}))})}function _(e,t){var r=t.screen,n=t.view;r.ctx.clearRect(0,0,r.width,r.height),n===Oe&&(T(e,t),y(e,t),w(e,t),S(e,t),P(e,t),x(e,t)),n===Ie&&(T(e,t),w(e,t),C(e,t)),n===Te&&(T(e,t),w(e,t),O(e,t)),n===Pe&&(T(e,t),w(e,t),b(e,t))}var L=e(function(e,t){function r(e,t){var r=this,n=t,i=[];this.getState=function(){return n},this.dispatch=function(t){return"function"==typeof t?t(r.dispatch,r.getState):(n=e(n,t),i.forEach(function(e){return e()}),t)},this.subscribe=function(e){return i.push(e),function(){i=i.filter(function(t){return t!==e})}},this.dispatch({type:"@@INIT"})}Object.defineProperty(t,"__esModule",{value:!0}),t.Store=r}),A=L.Store,M=function(e,t,r,n){var i=e.getContext("2d");e.style.margin="0 auto",e.style.display="block";var a="BODY"!==e.parentNode.nodeName?e.parentNode:null;a&&(a.style.margin="0 auto",a.style.display="block"),t<r?(e.style.height="100%",a&&(a.style.height="100%")):(e.style.width="100%",a&&(a.style.width="100%")),t*=n,r*=n,e.width=t,e.height=r,i.webkitImageSmoothingEnabled=!1,i.msImageSmoothingEnabled=!1,i.mozImageSmoothingEnabled=!1,i.imageSmoothingEnabled=!1;var o={width:t,height:r,cvs:e,ctx:i,scale:n,destroy:function(){Object.keys(o).map(function(e){return delete o[e]})}};return o},D=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){return t(n)},n.onerror=r,n.src=e})},W=function(e){var t=e.drawTime,r=e.updateTime,n=e.draw,i=e.update,a=e.panicAt,o=void 0===a?10:a,s=e.onPanic,u=void 0===s?function(){}:s,c=e.onFPS,l=void 0===c?function(){}:c,h=window.performance,d=t,f=r,p=h.now.bind(h),v=window.requestAnimationFrame.bind(window),m=0,y=null,g=p(),w=p(),E=0,S=0;!function I(e){y=v(I);var t=e-g;m+=t,g=e;var r=m-d>=0,a=Math.floor(m/f);if(a>=o)return m=0,g=p(),void u();for(;a-- >0;)m-=f,i(f);r&&n(m/d),E+=1,w+1e3<=e&&(S=.25*E+.75*S,E=0,w=e,l(S))}(p());var T=function(){y&&cancelAnimationFrame(y)};return{stop:T}},N=1e3/60,F=100,k="GAME_TICK",U="SWIPE_UP",B="SWIPE_DOWN",H="ACTIVATE",G="ACTIVATE_CEASE",V="NEW_CUSTOMER",K="DEBUG_TOGGLE",j="LOG_ENTRY_ADDED",Y="NEXT_LEVEL",J="CUSTOMER_DRINK_READY",q="ORDER_COUNTER",Z="STEAMER",z="GROUPHEAD",X="GRINDER",Q="HOT_WATER",$="TRASH",ee="EMPTY_COUNTER",te="PICKUP_COUNTER",re="CUP_COUNTER",ne="COUNTER_FLOOR",ie="SHOP_FLOOR",ae="DECORATIVE_PLANT",oe="SHOP_DOOR",se="SHOP_WINDOW",ue="CLEAN_CUP",ce="FILLED_AMERICANO_CUP",le="FILLED_CAPPUCCINO_CUP",he="FILLED_ESPRESSO_CUP",de="CLEAN_PORTAFILTER",fe="FILLED_PORTAFILTER",pe="FILLED_STEAMED_MILK_CUP",ve="FILLED_HOT_WATER_CUP",me="BARISTA",ye="CHECKMARK",ge=.5,we=0,Ee=10,Se="FONT_COLOR_WHITE",Te="BOOT_GAME_VIEW",Ie="BETWEEN_LEVEL_VIEW",xe="SHOW_SUMMARY_VIEW",Oe="LEVEL_VIEW",Pe="SUMMARY_VIEW",be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},Ce=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},Re=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(u){i=!0,a=u}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_e=function(){return function(e,t){var r=t();if(r.view===Oe&&r.levelTime>=r.levelMaxTime)return e(r.levelIdx+1<r.levels.length?{type:Ie}:{type:xe})}},Le=function(){return function(e,t){var r=t();if(r.view===Oe){var n=a(r),i=r.player;if(i.has.length&&n.type===te){var o=function(){var t=h(i),n=r.customers,a=n.findIndex(function(e){return e.wants.type===t});if(a>-1){var o=n[a];return o.paid?{v:e({type:J,data:a})}:{v:e({type:j,data:"They need to pay to receive the drink!"})}}}();if("object"===("undefined"==typeof o?"undefined":be(o)))return o.v}if(!r.player.isActivating)return e({type:H})}return r.view===Te?e({type:Y}):r.view===Ie?e({type:Y}):void 0}},Ae=function(){return function(e,t){var r=t(),n=r.levelTime/r.levelMaxTime,i=n.toPrecision(2);if(!r.hasLoggedElapsedForPct[i])return"0.25"===i?(e({type:j,data:"Phew, a quarter through my shift!"}),void(r.hasLoggedElapsedForPct[i]=!0)):"0.5"===i?(e({type:j,data:"Halfway through my shift!"}),void(r.hasLoggedElapsedForPct[i]=!0)):"0.75"===i?(e({type:j,data:"Just a quarter of my shift left!"}),void(r.hasLoggedElapsedForPct[i]=!0)):"0.91"===i?(e({type:j,data:"I think I can see daylight!"}),void(r.hasLoggedElapsedForPct[i]=!0)):"0.92"===i?(e({type:j,data:"What is 'daylight'?"}),void(r.hasLoggedElapsedForPct[i]=!0)):"0.93"===i?(e({type:j,data:"I remember now!"}),void(r.hasLoggedElapsedForPct[i]=!0)):"0.94"===i?(e({type:j,data:"Daylight is definitely approaching!"}),void(r.hasLoggedElapsedForPct[i]=!0)):"0.95"===i?(e({type:j,data:"It's getting so bright!"}),void(r.hasLoggedElapsedForPct[i]=!0)):"0.96"===i?(e({type:j,data:"So bright..."}),void(r.hasLoggedElapsedForPct[i]=!0)):"0.97"===i?(e({type:j,data:"So sleepy..."}),void(r.hasLoggedElapsedForPct[i]=!0)):"0.98"===i?(e({type:j,data:"I can almost smell my bed..."}),void(r.hasLoggedElapsedForPct[i]=!0)):"0.99"===i?(e({type:j,data:"Almost time to close up!"}),void(r.hasLoggedElapsedForPct[i]=!0)):"1"===i?(e({type:j,data:"Everybody out!"}),void(r.hasLoggedElapsedForPct[i]=!0)):void 0}},Me=function(){return function(e,t){var r=t();if(r.view===Oe){var n=r.lastCustomerSpawnDT,i=r.levelTime,a=r.rng,o=r.customerNames,s=(r.customers,r.levels[r.levelIdx]),u=0,c=!1;s.wants.forEach(function(t){if(!c&&!t.hasSpawnedOnce&&(0===n&&i>=u||i-n>t.minimumTime)){var s=a();if(s>t.rarity){var l=void 0,h=!1;if(t.name)l=t.name,t.hasSpawnedOnce=!0,h=!0;else{var d=o.filter(function(e){return e.hasSpawned===!1});d.length||(o.forEach(function(e){return e.hasSpawned=!1}),d=o);var f=Math.floor(a()*(d.length-1)),p=d[f];p.hasSpawned=!0,l=p.name}e({type:V,data:{name:l,rare:h,wants:{type:t.type,name:t.type===ce?"Americano":t.type===he?"Espresso":t.type===le?"Cappuccino":"??????"}}}),e({type:j,data:"A new customer walked in!"}),0===r.lastCustomerSpawnDT&&e({type:j,data:"... I'd better take their money █."}),c=!0,r.lastCustomerSpawnDT=i}}})}}};R()}();